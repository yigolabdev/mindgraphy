module.exports=[53486,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(40475),g=a.i(3130),h=a.i(40695),i=a.i(5522),j=a.i(54161),k=a.i(56941),l=a.i(77421),m=a.i(48817),n=a.i(56711);let o=new Date,p=[{id:"file-1",name:"최종 보정 사진 (고해상도)",type:"final",description:"선택하신 50장의 최종 보정 사진입니다",size:"2.4 GB",sizeBytes:24e8,format:"ZIP (JPEG)",expiresAt:(0,n.format)((0,l.addDays)(o,30),"yyyy-MM-dd"),isExpired:!1,requiresPassword:!0,password:"1234",downloadCount:1,maxDownloads:5},{id:"file-2",name:"원본 사진 (전체)",type:"original",description:"촬영된 모든 원본 사진 (450장)",size:"8.7 GB",sizeBytes:87e8,format:"ZIP (RAW + JPEG)",expiresAt:(0,n.format)((0,l.addDays)(o,60),"yyyy-MM-dd"),isExpired:!1,requiresPassword:!1,downloadCount:0,maxDownloads:3},{id:"file-3",name:"디지털 앨범 PDF",type:"album",description:"디자인 편집된 앨범 파일",size:"156 MB",sizeBytes:156e6,format:"PDF",expiresAt:(0,n.format)((0,l.addDays)(o,90),"yyyy-MM-dd"),isExpired:!1,requiresPassword:!1,downloadCount:2,maxDownloads:10}],q={id:"file-expired",name:"스냅 사진 (이전 버전)",type:"original",description:"이전에 제공되었던 스냅 사진",size:"1.2 GB",sizeBytes:12e8,format:"ZIP (JPEG)",expiresAt:(0,n.format)((0,m.subDays)(o,5),"yyyy-MM-dd"),isExpired:!0,requiresPassword:!1,downloadCount:3,maxDownloads:5};var r=a.i(84505),s=a.i(70106);let t=(0,s.default)("file-archive",[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]]),u=(0,s.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var v=a.i(92e3),w=a.i(67453),x=a.i(41710);let y=(0,s.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var z=a.i(41675);let A=(0,s.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var B=a.i(77156);let C=(0,s.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var D=a.i(23292),E=a.i(97895),F=a.i(2491);function G({params:a}){let{token:l}=(0,c.use)(a),m=(0,d.useRouter)(),s=(0,k.getClientDataByToken)(l),[G]=(0,c.useState)([...p,q]),[H,I]=(0,c.useState)({}),[J,K]=(0,c.useState)({}),[L,M]=(0,c.useState)({});if(!s)return m.push(`/c/${l}/invalid`),null;let N=async a=>{M(b=>({...b,[a.id]:!0}));let b=a.requiresPassword?H[a.id]:void 0,c=((a,b)=>{if(console.log("=== Download Attempt ==="),console.log("File:",a.name),console.log("Type:",a.type),console.log("Size:",a.size),console.log("Format:",a.format),console.log("Requires Password:",a.requiresPassword),a.isExpired)return console.log("Status: FAILED - File expired"),console.log("Expired on:",a.expiresAt),{success:!1,message:"파일이 만료되었습니다"};if(a.maxDownloads&&a.downloadCount>=a.maxDownloads)return console.log("Status: FAILED - Max downloads exceeded"),console.log(`Download count: ${a.downloadCount} / ${a.maxDownloads}`),{success:!1,message:"다운로드 횟수를 초과했습니다"};if(a.requiresPassword){if(console.log("Password required:",!0),console.log("Entered password:",b||"(none)"),console.log("Expected password:",a.password||"(not set)"),!b)return console.log("Status: FAILED - No password provided"),{success:!1,message:"비밀번호를 입력해주세요"};if(b!==a.password)return console.log("Status: FAILED - Incorrect password"),{success:!1,message:"비밀번호가 올바르지 않습니다"}}return console.log("Status: SUCCESS"),console.log("Download URL: (mock) https://download.mindgraphy.com/files/"+a.id),console.log("========================"),{success:!0,message:"다운로드를 시작합니다",downloadUrl:`https://download.mindgraphy.com/files/${a.id}`}})(a,b);await new Promise(a=>setTimeout(a,1e3)),M(b=>({...b,[a.id]:!1})),c.success?D.toast.success(c.message):D.toast.error(c.message)};return(0,b.jsx)(f.ClientPortalLayout,{token:l,children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(e.default,{href:`/c/${l}`,children:(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,b.jsx)(A,{className:"mr-2 h-4 w-4"}),"진행 상황으로 돌아가기"]})}),(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"다운로드"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"최종 결과물을 다운로드하실 수 있습니다"})]}),(0,b.jsx)(g.Card,{className:"border-blue-500 bg-blue-50",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(v.AlertCircle,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-blue-900 mb-1",children:"다운로드 안내"}),(0,b.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[(0,b.jsx)("li",{children:"파일은 만료일까지만 다운로드 가능합니다"}),(0,b.jsx)("li",{children:"다운로드 횟수 제한이 있을 수 있습니다"}),(0,b.jsx)("li",{children:"비밀번호가 필요한 파일은 입력 후 다운로드하세요"}),(0,b.jsx)("li",{children:"다운로드 문제 시 담당 작가에게 문의해주세요"})]})]})]})})}),(0,b.jsx)("div",{className:"space-y-4",children:G.map(a=>{let c=!a.isExpired&&(!a.maxDownloads||!(a.downloadCount>=a.maxDownloads)),d=Math.ceil((new Date(a.expiresAt).getTime()-o.getTime())/864e5),e=d<=7&&d>0,f=L[a.id];return(0,b.jsxs)(g.Card,{className:(0,E.cn)("transition-all",a.isExpired&&"opacity-60 border-red-200",e&&"border-orange-300"),children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,b.jsx)("div",{className:(0,E.cn)("flex h-12 w-12 items-center justify-center rounded-lg",a.isExpired?"bg-gray-200":"bg-blue-100"),children:(0,b.jsx)(t,{className:(0,E.cn)("h-6 w-6",a.isExpired?"text-gray-500":"text-blue-600")})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)(g.CardTitle,{className:"text-xl mb-1",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(j.Badge,{className:(0,E.cn)({final:"bg-green-100 text-green-800",original:"bg-blue-100 text-blue-800",album:"bg-purple-100 text-purple-800"}[a.type]),children:{final:"최종 보정본",original:"원본 파일",album:"앨범"}[a.type]}),a.isExpired?(0,b.jsx)(j.Badge,{variant:"destructive",children:"만료됨"}):e?(0,b.jsxs)(j.Badge,{variant:"destructive",className:"bg-orange-500",children:[d,"일 남음"]}):null,a.requiresPassword&&(0,b.jsxs)(j.Badge,{variant:"secondary",children:[(0,b.jsx)(u,{className:"mr-1 h-3 w-3"}),"비밀번호 필요"]})]})]})]})})}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(y,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"용량"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:a.size})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"형식"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:a.format})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(z.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"만료일"}),(0,b.jsx)("p",{className:(0,E.cn)("text-sm font-medium",a.isExpired&&"text-red-600",e&&"text-orange-600"),children:(0,n.format)(new Date(a.expiresAt),"M월 d일",{locale:F.ko})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(x.Clock,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"다운로드"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:a.isExpired?"만료됨":a.maxDownloads&&a.downloadCount>=a.maxDownloads?"다운로드 횟수 초과":`${a.downloadCount} / ${a.maxDownloads||"∞"} 다운로드`})]})]})]}),a.requiresPassword&&!a.isExpired&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-sm font-medium",children:["비밀번호 ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(i.Input,{type:J[a.id]?"text":"password",placeholder:"비밀번호를 입력하세요",value:H[a.id]||"",onChange:b=>{var c,d;return c=a.id,d=b.target.value,void I(a=>({...a,[c]:d}))},disabled:!c}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.id,void K(a=>({...a,[b]:!a[b]}))},className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:J[a.id]?(0,b.jsx)(C,{className:"h-4 w-4"}):(0,b.jsx)(B.Eye,{className:"h-4 w-4"})})]})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"비밀번호는 계약 시 전달받으신 번호입니다 (데모: 1234)"})]}),a.isExpired&&(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),(0,b.jsxs)("p",{className:"text-sm text-red-700",children:["이 파일은 ",(0,n.format)(new Date(a.expiresAt),"yyyy년 M월 d일",{locale:F.ko}),"에 만료되었습니다. 재발급이 필요한 경우 담당 작가에게 문의해주세요."]})]}),!a.isExpired&&a.maxDownloads&&a.downloadCount>=a.maxDownloads&&(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4 text-orange-600 flex-shrink-0"}),(0,b.jsxs)("p",{className:"text-sm text-orange-700",children:["다운로드 횟수(",a.maxDownloads,"회)를 모두 사용했습니다. 추가 다운로드가 필요한 경우 담당 작가에게 문의해주세요."]})]}),(0,b.jsx)(h.Button,{onClick:()=>N(a),disabled:!c||f,className:"w-full h-12",size:"lg",children:f?(0,b.jsx)(b.Fragment,{children:"처리 중..."}):a.isExpired?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.AlertCircle,{className:"mr-2 h-5 w-5"}),"만료됨"]}):c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Download,{className:"mr-2 h-5 w-5"}),"다운로드"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.AlertCircle,{className:"mr-2 h-5 w-5"}),"다운로드 불가"]})})]})]},a.id)})}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{className:"text-lg",children:"도움이 필요하신가요?"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(w.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("p",{className:"text-sm",children:["다운로드 문제가 있으신가요? 담당 작가 ",s.photographerName,"에게 연락하세요: ",s.photographerPhone]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(w.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("p",{className:"text-sm",children:"파일이 만료되었거나 추가 다운로드가 필요한 경우 재발급 요청이 가능합니다"})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(w.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("p",{className:"text-sm",children:"다운로드한 파일은 안전한 곳에 백업하여 보관하시기 바랍니다"})]})]})]})]})})}a.s(["default",()=>G],53486)}];

//# sourceMappingURL=app_%28client%29_c_%5Btoken%5D_download_page_tsx_5c59a3f3._.js.map